---

- name: "18.9.19.2 | PATCH | Ensure Configure registry policy processing Do not apply during periodic background processing is set to Enabled FALSE"
  ansible.windows.win_regedit:
      path: HKLM:\Software\Policies\Microsoft\Windows\Group Policy\{35378Eac-683F-11D2-A89A-00C04Fbbcfa2}
      name: NoBackgroundPolicy
      data: 0
      type: dword
  when:
      - win10cis_rule_18_9_19_2
  tags:
      - level1-corporate-enterprise-environment
      - rule_18.9.19.2
      - automated
      - patch

- name: "18.9.19.3 | PATCH | Ensure Configure registry policy processing Process even if the Group Policy objects have not changed is set to Enabled TRUE"
  ansible.windows.win_regedit:
      path: HKLM:\Software\Policies\Microsoft\Windows\Group Policy\{35378Eac-683F-11D2-A89A-00C04Fbbcfa2}
      name: NoGPOListChanges
      data: 0
      type: dword
  when:
      - win10cis_rule_18_9_19_3
  tags:
      - level1-corporate-enterprise-environment
      - rule_18.9.19.3
      - automated
      - patch

- name: "18.9.19.4 | PATCH | Ensure Continue experiences on this device is set to Disabled"
  ansible.windows.win_regedit:
      path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\System
      name: EnableCdp
      data: 0
      type: dword
  when:
      - win10cis_rule_18_9_19_4
  tags:
      - level1-corporate-enterprise-environment
      - rule_18.9.19.4
      - automated
      - patch

- name: "18.9.19.5 | PATCH | Ensure Turn off background refresh of Group Policy is set to Disabled"
  ansible.windows.win_regedit:
      path: HKLM:\Software\Microsoft\Windows\Currentversion\Policies\System\DisableBkGndGroupPolicy
      name: DisableBkGndGroupPolicy
      data: 1
      type: dword
  when:
      - win10cis_rule_18_9_19_5
  tags:
      - level1-corporate-enterprise-environment
      - rule_18.9.19.5
      - automated
      - patch
